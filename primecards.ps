%!PS
%%Creator: Harald Boegeholz
%%Title: Cards for prime number game
%%DocumentMedia: A4
%%Orientation: Portrait
%%Pages: (atend)
%%EndComments
/pageWidth 595 def
/pageHeight 842 def
/xstep pageWidth 3 div def
/ystep pageHeight 4 div def

/fontCardNo
{
    /Helvetica-Bold findfont 120 scalefont setfont
} def

% Calculate the midpoint of the bounding box of a string
/stringMidpoint {
    gsave
    newpath
    0 0 moveto
    false charpath
    flattenpath
    pathbbox
    /ury exch def
    /urx exch def
    /lly exch def
    /llx exch def
    urx llx sub 2 div
    ury lly sub 2 div
    grestore
} def

% Show the string centered on the current point
/showCentered {
    dup stringMidpoint neg exch neg exch rmoveto
    show
} def

/paintSymbol
{
    4 1 roll setrgbcolor
    gsave
    currentpoint newpath 7 0 360 arc
    gsave 1 setgray fill grestore
    % 0.8 setgray 0.5 setlinewidth stroke
    grestore
    /ZapfDingbats findfont 16 scalefont setfont showCentered
} def


% procedures to render a symbol for each prime at the current location
/primeProcedures
<<
    2 { 1 0 0 <6C> paintSymbol }
    3 { 0 0.8 0 <6E> paintSymbol }
    5 { 0 0 1 <3A> paintSymbol }
    7 { 1 0.75 0 <48> paintSymbol }
    11 { 0 0.7 0.7 <75> paintSymbol }
    13 { 0.75 0 1 <36> paintSymbol }
    17 { 0.3 0.6 0.6 <73> paintSymbol }
    19 { 0 0 0 <74> paintSymbol }
    23 { 0 0 0 <76> paintSymbol }
    29 { 0 0 0 <4A> paintSymbol }
    31 { 0 0 0 <5F> paintSymbol }
    37 { 0 0 0 <33> paintSymbol }
    41 { 0 0 0 <6D> paintSymbol }
    43 { 0 0 0 <6F> paintSymbol }
    47 { 0 0 0 <3D> paintSymbol }
    53 { 0 0 0 <66> paintSymbol }
    59 { 0 0 0 <A8> paintSymbol }
    61 { 0 0 0 <A9> paintSymbol }
    67 { 0 0 0 <AA> paintSymbol }
    71 { 0 0 0 <AB> paintSymbol }
    73 { 0 0 0 <DC> paintSymbol }
    79 { 0 0 0 <25> paintSymbol }
    83 { 0 0 0 <2F> paintSymbol }
    89 { 0 0 0 <41> paintSymbol }
    97 { 0 0 0 <7E> paintSymbol }
>> def

/cardPrimes
<<
    1  [2 3 3 3 5 7 11 13 17 19]
    2  [2 2 2 2 2 3 5 7 23 29]
    3  [2 3 5 7 11 13 17 19 31 37]
    4  [2 3 5 7 7 23 29 41 43 47]
    5  [2 3 5 7 11 13 17 19 53 59]
    6  [2 3 5 7 23 29 31 37 61 67]
    7  [2 3 5 11 13 17 19 71 73 79]
    8  [2 3 5 23 29 41 43 47 83 89]
    9  [2 3 5 11 13 17 19 31 37 97]
>> def

/cardColors
<<
    1 [0.7 0.7 0.7  0.7 0.7 0.7]
    2 [1 0 0  1 0 0]
    3 [0 0.8 0  0 0.8 0]
    4 [1 0 0  0.5 0 0]
    5 [0 0 1  0 0 1]
    6 [0 0.8  0 1 0 0]
    7 [1 0.75 0  1 0.75 0]
    8 [1 0 0  0 0 0]
    9 [0 0.8 0  0 0.4 0]
>> def

/drawCardNo
{
    fontCardNo 
    dup (xxx) cvs /s exch def
    s stringMidpoint neg exch neg exch rmoveto
    cardColors exch get
    aload pop 6 3 roll
    setrgbcolor
    gsave s show grestore
    setrgbcolor
    s true charpath 5 setlinewidth stroke
} def



/grid
{
    0.5 setgray
    0.5 setlinewidth

    1 1 2
    {
        xstep mul 0 moveto 0 pageHeight rlineto stroke
    } for

    1 1 3
    {
        ystep mul 0 exch moveto pageWidth 0 rlineto stroke
    } for
} def


cardPrimes
{ % forall
    /primes exch def
    /cardno exch def
    /i 0 def
    grid
    primes
    { % forall
        pop
        i 3 mod xstep mul i 3 idiv ystep mul moveto

        gsave
        0.5 xstep mul 0.7 ystep mul rmoveto
        cardno drawCardNo
        grestore

        /j 0 def
        primes
        { % forall
            gsave
            xstep 0.2 mul ystep 0.15 mul rmoveto
            j 5 mod xstep mul 0.15 mul j 5 idiv ystep mul 0.15 mul rmoveto
            primeProcedures exch get exec
            grestore
            /j j 1 add def
        } forall
        /i i 1 add def
    } forall
    showpage

    /i 0 def
    % grid
    primes
    { % forall
        2 i 3 mod sub xstep mul i 3 idiv ystep mul moveto
        0.5 xstep mul 0.15 ystep mul rmoveto
        primeProcedures exch get exec
        /i i 1 add def
    } forall
    showpage
} forall

%%EOF
